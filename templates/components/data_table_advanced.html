{# Advanced Data Table Component #}
{# Sortable, filterable table with pagination support #}
{# Usage:
   {% include "components/data_table_advanced.html" with context %}
   {# table_columns=[...], table_rows=[...], table_searchable=true #}
#}

<div class="space-y-4">
  <!-- Search and Controls -->
  <div class="flex gap-2 items-center">
    <!-- Search Input -->
    {% if table_searchable %}
      <div class="flex-1 relative">
        <input
          type="text"
          placeholder="Search..."
          x-model="searchTerm"
          @input="filterTable()"
          class="
            w-full px-4 py-2 text-sm rounded-md border border-slate-300 dark:border-slate-600
            bg-white dark:bg-slate-950
            text-slate-900 dark:text-slate-50
            placeholder:text-slate-400 dark:placeholder:text-slate-600
            focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2
            dark:focus-visible:ring-offset-slate-950
          "
        />
        <svg class="absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
        </svg>
      </div>
    {% endif %}

    <!-- View Toggle (optional) -->
    {% if table_view_toggle %}
      <div class="flex gap-1 border border-slate-300 dark:border-slate-600 rounded-md p-1">
        <button class="p-2 text-slate-400 hover:text-slate-900 dark:hover:text-slate-100 transition-colors">
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
            <path d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"></path>
          </svg>
        </button>
        <button class="p-2 text-slate-700 dark:text-slate-300 border-l border-slate-300 dark:border-slate-600">
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
            <path d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"></path>
          </svg>
        </button>
      </div>
    {% endif %}
  </div>

  <!-- Table -->
  <div class="overflow-x-auto rounded-lg border border-slate-200 dark:border-slate-800">
    <table class="w-full">
      <!-- Header -->
      <thead class="bg-slate-50 dark:bg-slate-950 border-b border-slate-200 dark:border-slate-800">
        <tr>
          {% for column in table_columns %}
            <th
              @click="{% if column.sortable %}sortColumn('{{ column.key }}'){% endif %}"
              class="
                px-4 py-3 text-left font-semibold text-xs uppercase tracking-wider
                text-slate-700 dark:text-slate-300
                {% if column.sortable %}cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-900{% endif %}
                transition-colors
              "
            >
              <div class="flex items-center gap-2">
                {{ column.label }}
                {% if column.sortable %}
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4"></path>
                  </svg>
                {% endif %}
              </div>
            </th>
          {% endfor %}
        </tr>
      </thead>

      <!-- Body -->
      <tbody class="divide-y divide-slate-200 dark:divide-slate-800">
        <template x-for="row in filteredRows" :key="row.id">
          <tr class="hover:bg-slate-50 dark:hover:bg-slate-900/50 transition-colors">
            <template x-for="column in columns" :key="column.key">
              <td class="px-4 py-3 text-sm text-slate-900 dark:text-slate-50">
                <span x-text="row[column.key]"></span>
              </td>
            </template>
          </tr>
        </template>
      </tbody>
    </table>
  </div>

  <!-- Footer with Results Info -->
  {% if table_show_footer %}
    <div class="flex items-center justify-between text-sm text-slate-600 dark:text-slate-400">
      <p>
        Showing
        <span class="font-semibold text-slate-900 dark:text-slate-50">1</span>
        to
        <span class="font-semibold text-slate-900 dark:text-slate-50">{{ table_rows|length }}</span>
        of
        <span class="font-semibold text-slate-900 dark:text-slate-50">{{ table_rows|length }}</span>
        results
      </p>

      <!-- Pagination -->
      <div class="flex gap-2">
        <button class="px-3 py-1 rounded border border-slate-300 dark:border-slate-600 hover:bg-slate-100 dark:hover:bg-slate-900 transition-colors">
          Previous
        </button>
        <button class="px-3 py-1 rounded border border-slate-300 dark:border-slate-600 hover:bg-slate-100 dark:hover:bg-slate-900 transition-colors">
          Next
        </button>
      </div>
    </div>
  {% endif %}
</div>

<!-- Alpine.js Logic -->
<script>
document.addEventListener('alpine:init', () => {
  // Data table functionality would be initialized here
  // This is a template - implementation depends on your backend
});
</script>
